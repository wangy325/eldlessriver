<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>内部类—Java基础系列之九 - Endless River</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="wangy325" /><meta name="description" content="将一个类定义在另一个类的内部，这就是内部类
" />






<meta name="generator" content="Hugo 0.55.6 with even 4.0.0" />


<link rel="canonical" href="https://wangy325.github.io/endlessriver/post/tech/basic_java/%E5%86%85%E9%83%A8%E7%B1%BB/" />
<link rel="apple-touch-icon" sizes="180x180" href="/endlessriver/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/endlessriver/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/endlessriver/favicon-16x16.png">
<link rel="manifest" href="/endlessriver/manifest.json">
<link rel="mask-icon" href="/endlessriver/safari-pinned-tab.svg" color="#5bbad5">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<link href="/endlessriver/dist/even.f64a7681.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="内部类—Java基础系列之九" />
<meta property="og:description" content="将一个类定义在另一个类的内部，这就是内部类" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://wangy325.github.io/endlessriver/post/tech/basic_java/%E5%86%85%E9%83%A8%E7%B1%BB/" />
<meta property="article:published_time" content="2020-04-23T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2020-05-28T19:52:52&#43;08:00"/>

<meta itemprop="name" content="内部类—Java基础系列之九">
<meta itemprop="description" content="将一个类定义在另一个类的内部，这就是内部类">


<meta itemprop="datePublished" content="2020-04-23T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2020-05-28T19:52:52&#43;08:00" />
<meta itemprop="wordCount" content="5191">



<meta itemprop="keywords" content="Java基础," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="内部类—Java基础系列之九"/>
<meta name="twitter:description" content="将一个类定义在另一个类的内部，这就是内部类"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/endlessriver/" class="logo">Endless River</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/endlessriver/">
        <li class="mobile-menu-item">主页</li>
      </a><a href="/endlessriver/post/">
        <li class="mobile-menu-item">归档</li>
      </a><a href="/endlessriver/tags/">
        <li class="mobile-menu-item">标签</li>
      </a><a href="/endlessriver/about/">
        <li class="mobile-menu-item">关于</li>
      </a><a href="/endlessriver/friendlink/">
        <li class="mobile-menu-item">友链</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/endlessriver/" class="logo">Endless River</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/endlessriver/">主页</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/endlessriver/post/">归档</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/endlessriver/tags/">标签</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/endlessriver/about/">关于</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/endlessriver/friendlink/">友链</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">内部类—Java基础系列之九</h1>

      <div class="post-meta">
          <span>
              <span class="icomoonfree icon-calendar"></span>
              <span class="post-time"> 2020-04-23</span>
          </span>

        <div class="post-category">
              <span class="icomoonfree icon-folder"></span>
            <a href="/endlessriver/categories/java/"> Java </a>
            </div>
          <span class="icomoonfree icon-sigma"></span>
          <span class="more-meta analyse"> 约 5191 字 </span>
          <span class="icomoonfree icon-clock"></span>
          <span class="more-meta analyse"> 预计阅读 11 分钟 </span>
        <span class="icomoonfree icon-eye"></span>
          <span id="busuanzi_container_page_pv" class="more-meta"> <span id="busuanzi_value_page_pv"><img src="/endlessriver/img/spinner.svg" alt="spinner.svg"/></span> 次阅读 </span>
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">目录</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#10-1-访问外部类">10.1 访问外部类</a></li>
<li><a href="#10-2-this和-new">10.2 .this和.new</a></li>
<li><a href="#10-3-局部内部类">10.3 局部内部类</a>
<ul>
<li><a href="#10-3-1-方法中的内部类">10.3.1 方法中的内部类</a></li>
<li><a href="#10-3-2-任意域中的内部类">10.3.2 任意域中的内部类</a></li>
</ul></li>
<li><a href="#10-4-匿名内部类">10.4 匿名内部类</a>
<ul>
<li><a href="#10-4-1-实现接口">10.4.1 实现接口</a></li>
<li><a href="#10-4-2-继承超类">10.4.2 继承超类</a></li>
<li><a href="#10-4-3-再论工厂方法">10.4.3 再论工厂方法</a></li>
<li><a href="#10-4-4-与lambda表达式">10.4.4 与lambda表达式</a></li>
</ul></li>
<li><a href="#10-5-静态内部类">10.5 静态内部类</a></li>
<li><a href="#10-6-接口中的内部类">10.6 接口中的内部类</a></li>
</ul></li>
</ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>将一个类定义在另一个类的内部，这就是内部类</p>

<blockquote>
<p>定义言简意赅 ，内涵丰富多彩</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Flight2</span> <span class="o">{</span>
  	<span class="c1">// inner class
</span><span class="c1"></span>    <span class="kd">class</span> <span class="nc">Comp</span><span class="o">{</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">(){</span>
            <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">class</span> <span class="nc">Dest</span><span class="o">{</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">to</span><span class="o">;</span>
        <span class="kd">public</span> <span class="nf">Dest</span><span class="o">(</span><span class="n">String</span> <span class="n">to</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">to</span> <span class="o">=</span> <span class="n">to</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">showDest</span><span class="o">(){</span>
            <span class="k">return</span> <span class="n">to</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
	<span class="c1">// use method to get inner class instance
</span><span class="c1"></span>    <span class="kd">public</span> <span class="n">Comp</span> <span class="nf">comp</span><span class="o">(){</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">Comp</span><span class="o">();</span>
    <span class="o">}</span>
	<span class="c1">// use method to get inner class instance
</span><span class="c1"></span>    <span class="kd">public</span> <span class="n">Dest</span> <span class="nf">dest</span><span class="o">(</span><span class="n">String</span> <span class="n">to</span><span class="o">){</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">Dest</span><span class="o">(</span><span class="n">to</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">ship</span><span class="o">(){</span>
        <span class="n">Comp</span> <span class="n">c</span> <span class="o">=</span> <span class="n">comp</span><span class="o">();</span>
      	<span class="n">c</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&#34;South Air&#34;</span><span class="o">)</span>
        <span class="n">Dest</span> <span class="n">d</span> <span class="o">=</span> <span class="n">dest</span><span class="o">(</span><span class="s">&#34;HK&#34;</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;the flight is &#34;</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34; to &#34;</span> <span class="o">+</span> <span class="n">d</span><span class="o">.</span><span class="na">showDest</span><span class="o">());</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Flight2</span> <span class="n">f2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Flight2</span><span class="o">();</span>
        <span class="n">f2</span><span class="o">.</span><span class="na">ship</span><span class="o">();</span>
    	<span class="c1">// OuterClassName.InnerClassName to refer inner class
</span><span class="c1"></span>        <span class="n">Flight2</span> <span class="n">f2s</span> <span class="o">=</span>  <span class="k">new</span> <span class="n">Flight2</span><span class="o">();</span>
        <span class="n">Flight2</span><span class="o">.</span><span class="na">Comp</span> <span class="n">comp</span> <span class="o">=</span> <span class="n">f2s</span><span class="o">.</span><span class="na">comp</span><span class="o">();</span>
        <span class="n">Flight2</span><span class="o">.</span><span class="na">Dest</span> <span class="n">d2</span> <span class="o">=</span> <span class="n">f2s</span><span class="o">.</span><span class="na">dest</span><span class="o">(</span><span class="s">&#34;New York&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>通过<code>new</code>关键字实例化内部类和使用普通类并没有什么区别</p>

<p>需要说明的是：当创建一个内部类的引用时，需要使用<code>OuterClassName.InnerClassName</code>这样的格式指明内部类的类型</p>

<h2 id="10-1-访问外部类">10.1 访问外部类</h2>

<blockquote>
<p>当生成一个内部类对象时，此对象与制造它的外围对象（ <em>enclosing object</em> ）就形成了某种联系，内部类能够访问外围对象的<strong>所有成员</strong>，而不需要任何特殊条件</p>
</blockquote>

<p>考虑如下示例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">// 内部类实现的接口
</span><span class="c1"></span><span class="kd">interface</span> <span class="nc">Selector</span><span class="o">{</span>
    <span class="kt">boolean</span> <span class="nf">end</span><span class="o">();</span>
    <span class="n">Object</span> <span class="nf">current</span><span class="o">();</span>
    <span class="kt">void</span> <span class="nf">next</span><span class="o">();</span>
<span class="o">}</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Sequence</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">Object</span><span class="o">[]</span> <span class="n">items</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">next</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Sequence</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">items</span>  <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[</span><span class="n">size</span><span class="o">];</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">Object</span> <span class="n">o</span><span class="o">){</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">next</span> <span class="o">&lt;</span> <span class="n">items</span><span class="o">.</span><span class="na">length</span><span class="o">){</span>
            <span class="n">items</span><span class="o">[</span><span class="n">next</span><span class="o">++]</span> <span class="o">=</span> <span class="n">o</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
  	<span class="c1">// 内部类实现自接口
</span><span class="c1"></span>  	<span class="c1">// 这是一个private修饰的内部类
</span><span class="c1"></span>    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">SequenceSelector</span> <span class="kd">implements</span> <span class="n">Selector</span><span class="o">{</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
				<span class="c1">// 内部类直接访问了外围类的私有域
</span><span class="c1"></span>        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">end</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span>  <span class="n">i</span> <span class="o">==</span> <span class="n">items</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">}</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="n">Object</span> <span class="nf">current</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">items</span><span class="o">[</span><span class="n">i</span><span class="o">];</span> <span class="o">}</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span> <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">items</span><span class="o">.</span><span class="na">length</span><span class="o">)</span>  <span class="n">i</span><span class="o">++;</span>  <span class="o">}</span>
    <span class="o">}</span>
	<span class="c1">// 获取内部类实例
</span><span class="c1"></span>    <span class="kd">public</span> <span class="n">Selector</span> <span class="nf">selector</span><span class="o">(){</span> <span class="k">return</span> <span class="k">new</span> <span class="n">SequenceSelector</span><span class="o">();</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Sequence</span> <span class="n">s</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Sequence</span><span class="o">(</span><span class="n">10</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span><span class="n">10</span> <span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">s</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="n">Selector</span> <span class="n">selector</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="na">selector</span><span class="o">();</span>
      	<span class="c1">// equals to 
</span><span class="c1"></span>      	<span class="c1">// Sequence.SequenceSelector selector = s.selector();
</span><span class="c1"></span>        <span class="k">while</span> <span class="o">(!</span><span class="n">selector</span><span class="o">.</span><span class="na">end</span><span class="o">()){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">selector</span><span class="o">.</span><span class="na">current</span><span class="o">());</span>
            <span class="n">selector</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>这是一个简单的“迭代器”的例子，这个说明的是，在内部类里，无需任何说明，即可访问外围类的私有域。这是由于内部类在实例化时，必定<strong>捕获一个创建此内部类的外围类对象的引用</strong>（静态内部类除外），当在内部类访问外围类成员时，就使用那个引用访问</p>

<p>当使用<code>private</code>来修饰内部类时，情况有一些特殊。结论是当使用<code>private</code>修饰内部类时，<strong>内部类仅在外围类作用域中可用</strong>，在<strong>其他作用域内不可用</strong>，我们将上面的例子试图作如下修改：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">interface</span> <span class="nc">Selector</span><span class="o">{</span>
    <span class="kt">boolean</span> <span class="nf">end</span><span class="o">();</span>
    <span class="n">Object</span> <span class="nf">current</span><span class="o">();</span>
    <span class="kt">void</span> <span class="nf">next</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Sequence1</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">Object</span><span class="o">[]</span> <span class="n">items</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">next</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Sequence1</span><span class="o">(</span><span class="kt">int</span> <span class="n">size</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">items</span>  <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[</span><span class="n">size</span><span class="o">];</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="n">Object</span> <span class="n">o</span><span class="o">){</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">next</span> <span class="o">&lt;</span> <span class="n">items</span><span class="o">.</span><span class="na">length</span><span class="o">){</span>
            <span class="n">items</span><span class="o">[</span><span class="n">next</span><span class="o">++]</span> <span class="o">=</span> <span class="n">o</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">SequenceSelector</span> <span class="kd">implements</span> <span class="n">Selector</span><span class="o">{</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">end</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span>  <span class="n">i</span> <span class="o">==</span> <span class="n">items</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">}</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="n">Object</span> <span class="nf">current</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">items</span><span class="o">[</span><span class="n">i</span><span class="o">];</span> <span class="o">}</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">next</span><span class="o">()</span> <span class="o">{</span> <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">items</span><span class="o">.</span><span class="na">length</span><span class="o">)</span>  <span class="n">i</span><span class="o">++;</span>  <span class="o">}</span>
    <span class="o">}</span>
  	<span class="c1">// 此处返回内部类或其基类类型都可以
</span><span class="c1"></span>    <span class="kd">public</span> <span class="n">SequenceSelector</span> <span class="nf">selector</span><span class="o">(){</span> <span class="k">return</span> <span class="k">new</span> <span class="n">SequenceSelector</span><span class="o">();</span> <span class="o">}</span>

<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Sequence</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Sequence1</span> <span class="n">s</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Sequence1</span><span class="o">(</span><span class="n">10</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span><span class="n">10</span> <span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">s</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
        <span class="o">}</span>
      	<span class="c1">// 此处的返回只能向上转型为基类
</span><span class="c1"></span>        <span class="n">Selector</span> <span class="n">selector</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="na">selector</span><span class="o">();</span>
      	<span class="c1">// illegal！can not access. private class
</span><span class="c1"></span>      	<span class="c1">// Sequence.SequenceSelector selector = s.selector();
</span><span class="c1"></span>        <span class="k">while</span> <span class="o">(!</span><span class="n">selector</span><span class="o">.</span><span class="na">end</span><span class="o">()){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">selector</span><span class="o">.</span><span class="na">current</span><span class="o">());</span>
            <span class="n">selector</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>可以看到，当试图在另一个类中访问内部类时，编译器会给出错误信息——不能访问私有内部类，它被隐藏了</p>

<p>这是一种保护机制，除了<strong>内部类的外部类之外，任何人无法访问内部类</strong>，这样可以将内部类的实现（甚至其他不属于接口的实现）隐藏起来，这给Java编译器提供了生成高效代码的机会</p>

<h2 id="10-2-this和-new">10.2 .this和.new</h2>

<blockquote>
<p>在拥有外部类的引用之前，是不能创建内部类对象的，因为内部类总是和外部类建立着联系</p>

<p>当然，这个规则不适用于<strong>静态内部类</strong>（嵌套类）</p>
</blockquote>

<p>如果需要在内部类中生成对外部类对象的引用，就需要用到<code>.this</code></p>

<p>如果创建一个内部类对象，可以使用<code>.new</code></p>

<p>正如前面提到的，此例中的内部类不能使用<code>private</code>修饰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ThisNew</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">DotThis</span> <span class="n">d</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DotThis</span><span class="o">();</span>
      	<span class="c1">// OuterClassName.InnerClassName语法
</span><span class="c1"></span>        <span class="n">DotThis</span><span class="o">.</span><span class="na">Inner</span> <span class="n">ti</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="na">inner</span><span class="o">();</span>
        <span class="n">ti</span><span class="o">.</span><span class="na">outer</span><span class="o">().</span><span class="na">f</span><span class="o">();</span>
        <span class="n">DotNew</span> <span class="n">n</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DotNew</span><span class="o">();</span>
      	<span class="c1">// 使用 .new 获取内部类引用
</span><span class="c1"></span>        <span class="n">DotNew</span><span class="o">.</span><span class="na">Inner</span> <span class="n">ni</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="na">new</span> <span class="nf">Inner</span><span class="o">();</span>
        <span class="n">ni</span><span class="o">.</span><span class="na">f</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">DotThis</span><span class="o">{</span>
    <span class="kt">void</span> <span class="nf">f</span><span class="o">(){</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;DotThis.f()&#34;</span><span class="o">);}</span>
    <span class="kd">class</span> <span class="nc">Inner</span><span class="o">{</span>
      	<span class="c1">// 在内部类中生成外部类对象引用
</span><span class="c1"></span>        <span class="kd">public</span> <span class="n">DotThis</span> <span class="nf">outer</span><span class="o">(){</span><span class="k">return</span> <span class="n">DotThis</span><span class="o">.</span><span class="na">this</span><span class="o">;}</span>
    <span class="o">}</span>

    <span class="n">Inner</span> <span class="nf">inner</span><span class="o">(){</span> <span class="k">return</span> <span class="k">new</span> <span class="n">Inner</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">DotNew</span><span class="o">{</span>
    <span class="kd">class</span> <span class="nc">Inner</span><span class="o">{</span>
        <span class="kt">void</span> <span class="nf">f</span><span class="o">(){</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;DotNew.Inner.f()&#34;</span><span class="o">);</span> <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="10-3-局部内部类">10.3 局部内部类</h2>

<p>之前提到的示例中，内部类都是一个“单独的作用域”，那些内部类看起来都很容易理解，直观上都是把一个普通的Java类“放置”在另一个Java类内部</p>

<p>然而 ，内部类可以定义在一个<strong>方法里</strong>甚至<strong>任意的作用域</strong>内</p>

<h3 id="10-3-1-方法中的内部类">10.3.1 方法中的内部类</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">interface</span> <span class="nc">Dest</span><span class="o">{</span>
    <span class="n">String</span> <span class="nf">showDest</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Flight3</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="n">Dest</span> <span class="nf">dest</span><span class="o">(</span><span class="n">String</span> <span class="n">to</span><span class="o">){</span>
      	<span class="c1">// 内部类在方法的作用域中
</span><span class="c1"></span>        <span class="kd">class</span> <span class="nc">PDest</span> <span class="kd">implements</span> <span class="n">Dest</span><span class="o">{</span>
            <span class="kd">private</span> <span class="n">String</span> <span class="n">to</span><span class="o">;</span>
          	<span class="c1">// 私有构造器
</span><span class="c1"></span>            <span class="kd">private</span> <span class="nf">PDest</span><span class="o">(</span><span class="n">String</span> <span class="n">dest</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">to</span> <span class="o">=</span> <span class="n">dest</span><span class="o">;</span> <span class="o">}</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="n">String</span> <span class="nf">showDest</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">to</span><span class="o">;</span> <span class="o">}</span>
        <span class="o">}</span>
      	<span class="c1">// 构造内部类实例，向上转型
</span><span class="c1"></span>        <span class="k">return</span> <span class="k">new</span> <span class="n">PDest</span><span class="o">(</span><span class="n">to</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Flight3</span> <span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Flight3</span><span class="o">();</span>
        <span class="n">Dest</span> <span class="n">d</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="na">dest</span><span class="o">(</span><span class="s">&#34;Macao&#34;</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">d</span><span class="o">.</span><span class="na">showDest</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="o">/*</span>
<span class="n">Macao</span>
<span class="o">///:~</span></code></pre></td></tr></table>
</div>
</div>
<p>内部类PDest在<code>dest()</code>方法体内，只能在<code>dest()</code>中能够访问，<strong>其他地方无法访问</strong>，引出几个内涵：</p>

<ol>
<li>PDest类使用*权限修饰符*没有意义，编译器也警告你<strong>不能使用任何修饰符</strong></li>
<li>PDest类的构造器是私有的，实际上由于作用域的限制，其访问权限无论是私有还是公有意义不大</li>
</ol>

<h3 id="10-3-2-任意域中的内部类">10.3.2 任意域中的内部类</h3>

<p>参考如下例子</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Flight4</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">flight</span><span class="o">(</span><span class="kt">boolean</span> <span class="n">fly</span><span class="o">){</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">fly</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// inner class scope
</span><span class="c1"></span>            <span class="kd">class</span> <span class="nc">InternalFlight</span> <span class="o">{</span>
                <span class="kd">private</span> <span class="n">String</span> <span class="n">to</span><span class="o">;</span>
                <span class="n">InternalFlight</span><span class="o">(</span><span class="n">String</span> <span class="n">to</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">to</span> <span class="o">=</span> <span class="n">to</span><span class="o">;</span> <span class="o">}</span>
                <span class="n">String</span> <span class="nf">showDest</span><span class="o">(){</span><span class="k">return</span> <span class="n">to</span><span class="o">;}</span>
            <span class="o">}</span>
          	<span class="c1">// instance can only initialized here(in scope)
</span><span class="c1"></span>            <span class="n">InternalFlight</span> <span class="n">f</span> <span class="o">=</span>  <span class="k">new</span> <span class="n">InternalFlight</span><span class="o">(</span><span class="s">&#34;TaiPei&#34;</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">showDest</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="c1">// illegal access! out of scope
</span><span class="c1"></span>        <span class="c1">// InternalFlight f = new InternalFlight(&#34;TaiPei&#34;);
</span><span class="c1"></span>    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Flight4</span> <span class="n">f</span> <span class="o">=</span>  <span class="k">new</span> <span class="n">Flight4</span><span class="o">();</span>
        <span class="n">f</span><span class="o">.</span><span class="na">flight</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="o">/*</span>
<span class="n">TaiPei</span>
<span class="o">///:~</span></code></pre></td></tr></table>
</div>
</div>
<p>内部类<code>InternalFlight</code>定义在<code>if</code>语句的作用域内，无法在<code>if</code>语句的作用域之外创建对内部类的引用</p>

<p>同样地，定义在语句作用域的内部类也可以继承自接口，参考下例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">FlightShip</span> <span class="o">{</span>
    <span class="n">Dest</span> <span class="nf">flight</span><span class="o">(</span><span class="kt">boolean</span> <span class="n">fly</span><span class="o">){</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">fly</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// inner implements interface
</span><span class="c1"></span>            <span class="kd">class</span> <span class="nc">InternalFlight</span> <span class="kd">implements</span> <span class="n">Dest</span> <span class="o">{</span>
                <span class="kd">private</span> <span class="n">String</span> <span class="n">to</span><span class="o">;</span>
                <span class="n">InternalFlight</span><span class="o">(</span><span class="n">String</span> <span class="n">to</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">to</span> <span class="o">=</span> <span class="n">to</span><span class="o">;</span> <span class="o">}</span>
                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="n">String</span> <span class="nf">showDest</span><span class="o">(){</span><span class="k">return</span> <span class="n">to</span><span class="o">;}</span>
            <span class="o">}</span>
            <span class="n">InternalFlight</span> <span class="n">f</span> <span class="o">=</span>  <span class="k">new</span> <span class="n">InternalFlight</span><span class="o">(</span><span class="s">&#34;TaiPei&#34;</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">f</span><span class="o">);</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">f</span><span class="o">.</span><span class="na">showDest</span><span class="o">());</span>
          	<span class="c1">// upcast to interface
</span><span class="c1"></span>            <span class="k">return</span> <span class="n">f</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="c1">// illegal access!
</span><span class="c1"></span>        <span class="c1">// InternalFlight f = new InternalFlight(&#34;TaiPei&#34;);
</span><span class="c1"></span>    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Flight4</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">FlightShip</span> <span class="n">f</span> <span class="o">=</span>  <span class="k">new</span> <span class="n">FlightShip</span><span class="o">();</span>
        <span class="n">Dest</span> <span class="n">dest</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="na">flight</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">dest</span><span class="o">.</span><span class="na">showDest</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="o">/*</span>
<span class="n">innerclass</span><span class="o">.</span><span class="na">FlightShip$1InternalFlight</span><span class="nd">@74a14482</span>
<span class="n">TaiPei</span>
<span class="n">TaiPei</span>
<span class="o">///:~</span></code></pre></td></tr></table>
</div>
</div>
<p>上例中，定义在if语句块的内部类继承了Dest接口，并且包含内部类的方法返回了一个Dest引用（实际上是内部类对象引用的向上转型）</p>

<blockquote>
<p>它像不像一个工厂方法？</p>
</blockquote>

<h2 id="10-4-匿名内部类">10.4 匿名内部类</h2>

<p>不负责任地说，匿名内部类应该是实际应用中使用最多的内部类了</p>

<h3 id="10-4-1-实现接口">10.4.1 实现接口</h3>

<p>当你需要“<strong>创建一个接口的匿名类的对象</strong>”时，通过new表达式返回的引用被自动向上转型为接口的引用</p>

<p>参考下例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Flight5</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">AnonFlight</span> <span class="n">af</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AnonFlight</span><span class="o">();</span>
        <span class="n">Dest</span> <span class="n">hk</span> <span class="o">=</span> <span class="n">af</span><span class="o">.</span><span class="na">flight</span><span class="o">(</span><span class="s">&#34;HK&#34;</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">hk</span><span class="o">.</span><span class="na">showDest</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">AnonFlight</span> <span class="o">{</span>
    <span class="n">Dest</span> <span class="nf">flight</span><span class="o">(</span><span class="n">String</span> <span class="n">dest</span><span class="o">)</span> <span class="o">{</span>
      	<span class="c1">// 实现了Dest接口的匿名内部类
</span><span class="c1"></span>        <span class="k">return</span> <span class="k">new</span> <span class="n">Dest</span><span class="o">()</span> <span class="o">{</span>
          	<span class="c1">// 匿名内部类中还可以进行字段初始化
</span><span class="c1"></span>            <span class="kd">private</span> <span class="n">String</span> <span class="n">to</span> <span class="o">=</span> <span class="n">dest</span><span class="o">;</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="n">String</span> <span class="nf">showDest</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">to</span><span class="err">；</span><span class="o">}</span>
        <span class="o">};</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="o">/*</span>
<span class="n">HK</span>
<span class="o">///:~</span></code></pre></td></tr></table>
</div>
</div>
<p>匿名内部类常见的语法格式为：</p>

<p><em><code>
new SuperType(construction parameters){
    inner class method and data 
}
</code></em></p>

<p>上例中，我们传递“构造器参数”，实际上它不是构造器参数，只是用于<strong>内部类的字段初始化</strong></p>

<h3 id="10-4-2-继承超类">10.4.2 继承超类</h3>

<p>匿名内部类还可以继承自某个普通类，此种情况下，内部类还可能有一些特殊的行为——调用<strong>构造器实现实例初始化</strong></p>

<blockquote>
<p>实际上匿名内部类没有名字，也不可能有构造器</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Flight6</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Pistol</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Pistol</span><span class="o">();</span>
        <span class="n">Wrap</span> <span class="n">wrap</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="na">wrap</span><span class="o">(</span><span class="n">3</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">wrap</span><span class="o">.</span><span class="na">value</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Pistol</span> <span class="o">{</span>
    <span class="n">Wrap</span> <span class="nf">wrap</span><span class="o">(</span><span class="kt">int</span> <span class="n">x</span><span class="o">)</span> <span class="o">{</span>
      	<span class="c1">// 继承类的匿名内部类 
</span><span class="c1"></span>        <span class="k">return</span> <span class="k">new</span> <span class="n">Wrap</span><span class="o">(</span><span class="n">x</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">v</span><span class="o">;</span>
          	<span class="c1">// 使用{}实现类似构造器的行为（初始化字段）
</span><span class="c1"></span>            <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;extended initialized&#34;</span><span class="o">);</span>
              	<span class="c1">// 字段初始化
</span><span class="c1"></span>                <span class="n">v</span> <span class="o">=</span> <span class="kd">super</span><span class="o">.</span><span class="na">value</span><span class="o">()</span> <span class="o">*</span><span class="n">3</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="nd">@Override</span>
            <span class="kt">int</span> <span class="nf">value</span><span class="o">()</span> <span class="o">{</span>
                <span class="k">return</span> <span class="n">v</span> <span class="o">;</span>
            <span class="o">}</span>
        <span class="o">};</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="c1">// 基础类
</span><span class="c1"></span><span class="kd">class</span> <span class="nc">Wrap</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">i</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Wrap</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;base constructor&#34;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kt">int</span> <span class="nf">value</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">i</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="o">/*</span>
<span class="n">base</span> <span class="n">constructor</span>
<span class="n">extended</span> <span class="n">initialized</span>
<span class="n">9</span>
<span class="o">///:~</span></code></pre></td></tr></table>
</div>
</div>
<p>上例中，匿名内部类<code>new Wrap(x)</code>中由<code>wrap(int x)</code>传递来的参数<code>x</code>作为了基类的构造器参数，在构造内部类的时候<strong>首先调用了基类的构造器</strong>，这是可以预想的结果。同时，在匿名内部类中使用了<code>{}</code>语句来<strong>模拟匿名内部类的构造器行为</strong>——初始化字段信息， <code>super.value()</code>的返回值也说明了<strong>基类已经在构造内部类之前就已经实例化成功了</strong></p>

<blockquote>
<p><strong>双花括号语法：{{&hellip;}}</strong></p>

<p>其实上例给了一个启示：在内部类中使用<code>{}</code>进行了字段初始化，那么<code>{{}}</code>是否可以用来实例初字段始化呢？答案是肯定的，比如在初始化一个数组列表时</p>

<p><code>List&lt;String&gt; list = new ArrayList&lt;String&gt;(){{add(&quot;ali&quot;); add(&quot;google&quot;); add(&quot;amazon&quot;);}};</code></p>

<p>这样有一个便利，当一个对象只需要使用一次的时候，可以使用匿名数组列表</p>
</blockquote>

<h3 id="10-4-3-再论工厂方法">10.4.3 再论工厂方法</h3>

<p>在讨论接口的过程中，讨论了利用接口使代码与实现分离的<a href="#factory">工厂模式</a>，下例中使用匿名内部类优化代码时，会发现代码变得更加优雅</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SimpleFactory2</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">serviceConsumer</span><span class="o">(</span><span class="n">ServiceFactory</span> <span class="n">sf</span><span class="o">){</span>
        <span class="n">Service</span> <span class="n">s</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="na">getService</span><span class="o">();</span>
        <span class="n">s</span><span class="o">.</span><span class="na">service_a</span><span class="o">();</span>
        <span class="n">s</span><span class="o">.</span><span class="na">service_b</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">SimpleFactory2</span> <span class="n">sf</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SimpleFactory2</span><span class="o">();</span>
        <span class="n">sf</span><span class="o">.</span><span class="na">serviceConsumer</span><span class="o">(</span><span class="n">NameService</span><span class="o">.</span><span class="na">factory</span><span class="o">);</span>
        <span class="n">sf</span><span class="o">.</span><span class="na">serviceConsumer</span><span class="o">(</span><span class="n">AgeService</span><span class="o">.</span><span class="na">factory</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">interface</span> <span class="nc">Service</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">service_a</span><span class="o">();</span>
    <span class="kt">void</span> <span class="nf">service_b</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">interface</span> <span class="nc">ServiceFactory</span> <span class="o">{</span>
   <span class="n">Service</span> <span class="nf">getService</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">NameService</span> <span class="kd">implements</span> <span class="n">Service</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nf">NameService</span><span class="o">()</span> <span class="o">{}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">service_a</span><span class="o">()</span> <span class="o">{</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;NameService.service_a()&#34;</span><span class="o">);}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">service_b</span><span class="o">()</span> <span class="o">{</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;NameService.service_b()&#34;</span><span class="o">);}</span>
		<span class="c1">// 使用匿名内部类获取工厂类
</span><span class="c1"></span>  	<span class="c1">// 使用static避免服务的初始化，因为工厂是来获取实例的，已经初始化了就没意义了
</span><span class="c1"></span>    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ServiceFactory</span> <span class="n">factory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ServiceFactory</span><span class="o">()</span> <span class="o">{</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="n">Service</span> <span class="nf">getService</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">NameService</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">};</span>
    <span class="c1">// same as lambda expression below
</span><span class="c1"></span>    <span class="c1">// public static ServiceFactory factory = () -&gt; new NameService();
</span><span class="c1"></span><span class="o">}</span>

<span class="kd">class</span> <span class="nc">AgeService</span> <span class="kd">implements</span> <span class="n">Service</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nf">AgeService</span><span class="o">()</span> <span class="o">{</span> <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">service_a</span><span class="o">()</span> <span class="o">{</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;AgeService.service_a()&#34;</span><span class="o">);}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">service_b</span><span class="o">()</span> <span class="o">{</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;AgeService.service_b()&#34;</span><span class="o">);}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ServiceFactory</span> <span class="n">factory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ServiceFactory</span><span class="o">()</span> <span class="o">{</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="n">Service</span> <span class="nf">getService</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">AgeService</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">};</span>
    <span class="c1">// same as lambda expression below
</span><span class="c1"></span>    <span class="c1">// public static ServiceFactory factory = () -&gt; new AgeService();
</span><span class="c1"></span><span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li>服务类的构造器私有，使得无法从外部实例化构造器</li>
<li>静态字段获取工厂，实际上也只能使用静态字段</li>
<li>匿名内部类可以等价转换为lambda表达式</li>
</ul>

<h3 id="10-4-4-与lambda表达式">10.4.4 与lambda表达式</h3>

<p>Java SE 8引入lambda表达式之后，匿名内部类与lambda表达式的关系变得亲密起来，匿名内部类可以等价转换为lambda表达式，<strong>但这不是绝对的</strong></p>

<p>lambda表达式的本质是一个函数，在一般来讲，lambda表达式“实例化接口”时，该接口一般为<a href="#func_interface">函数式接口</a>，只需覆盖一个抽象方法，这是lambda能做的全部</p>

<p>而匿名内部类则要复杂的多，它是一个完整的类，除了没有构造器之外，其可以有字段利用参数进行初始化，其可以有<code>{}</code>statement实现类实例化操作等等，这种形式的匿名内部类，是无法等价为lambda表达式的</p>

<p>考虑lambda表达式体中<a href="#free_variable">自由变量</a>的几个约束，<strong>除了</strong>变量命名规则之外 ，其他规则同样在匿名内部类中适用，一些较老的资料（Java SE 7或之前）甚至常有这样的描述：</p>

<blockquote>
<p>Java编译器要求传入内部类（包括lambda表达式）的的参数必须显示使用<code>final</code>修饰</p>
</blockquote>

<p>就像这样：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">AnonFlight</span> <span class="o">{</span>
    <span class="n">Dest</span> <span class="nf">flight</span><span class="o">(</span><span class="kd">final</span> <span class="kt">int</span> <span class="n">dest</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">Dest</span><span class="o">()</span> <span class="o">{</span>
            <span class="kd">private</span> <span class="kt">int</span> <span class="n">to</span> <span class="o">=</span> <span class="n">dest</span><span class="o">;</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="n">String</span> <span class="nf">showDest</span><span class="o">()</span> <span class="o">{</span>  
              <span class="c1">// dest--； // not allowed!
</span><span class="c1"></span>              <span class="k">return</span> <span class="n">to</span><span class="err">；</span><span class="o">}</span>
        <span class="o">};</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>事实上，之前的示例中我们<strong>从来没有</strong>将内部类的参数引用声明为<code>final</code>，不过，尽管可以不用声明为<code>final</code>，<strong>约束依旧是存在的</strong>，你不能在内部类中修改参数（的引用）</p>

<p>编译器给出的信息像这样：</p>

<blockquote>
<p><em>Variable &lsquo;variable&rsquo; is accessed from within inner class, needs to be final or effectively final</em></p>
</blockquote>

<p>值得一提的是，上述约束对于<strong>局部内部类的参数引用</strong>同样适用</p>

<p>参考如下局部内部类的示例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="n">Dest</span> <span class="nf">dest</span><span class="o">(</span><span class="n">String</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">class</span> <span class="nc">PDest</span> <span class="kd">implements</span> <span class="n">Dest</span> <span class="o">{</span>
            <span class="kd">private</span> <span class="n">String</span> <span class="n">to</span><span class="o">;</span>
            <span class="kd">private</span> <span class="nf">PDest</span><span class="o">(</span><span class="n">String</span> <span class="n">dest</span><span class="o">)</span> <span class="o">{</span><span class="k">this</span><span class="o">.</span><span class="na">to</span> <span class="o">=</span> <span class="n">dest</span><span class="o">;}</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="n">String</span> <span class="nf">showDest</span><span class="o">()</span> <span class="o">{</span>
                <span class="c1">// t = t.concat(&#34;xxx&#34;); // not allowed!
</span><span class="c1"></span>                <span class="k">return</span> <span class="n">to</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">PDest</span><span class="o">(</span><span class="n">t</span><span class="o">);</span>
    <span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="10-5-静态内部类">10.5 静态内部类</h2>

<p>非静态内部类编译的时候，会<strong>提供一个对外部类的引用</strong>，这是在内部类中使用<code>.this</code>的前提</p>

<p>如果不需要这种内部类和外部类的联系，可以将内部类声明为<code>static</code>，这通常称为<strong>静态内部类</strong>或<strong>嵌套类</strong></p>

<p>如果使用静态内部类，那么意味着：</p>

<ul>
<li><p>不需要外围类即可创建静态内部类对象</p></li>

<li><p>静态内部类<strong>无法访问</strong>外围类的非静态对象</p></li>

<li><p>静态内部类可以有<code>static</code>字段和数据</p></li>
</ul>

<blockquote>
<p>普通内部类也能有静态字段，但是必须配合<code>final</code>声明为静态常量。原因很简单，Java希望静态字段只有一个实例，但是对每个外围类对象，会分别有一个内部类实例，如果这个字段不是<code>final</code>，那它可能不是唯一的</p>

<p>普通内部类不能有<code>static</code>方法</p>
</blockquote>

<ul>
<li>静态内部类可以嵌套<del>静态内部类</del>内部类</li>
</ul>

<blockquote>
<p>普通内部类也可以嵌套，这种嵌套关系变得愈发复杂</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Flight7</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
      	<span class="c1">// ERROR! out of scope! 
</span><span class="c1"></span>        <span class="c1">// StaticFlight.InnerComp comp = StaticFlight.comp();
</span><span class="c1"></span>      	<span class="c1">// private inner class must upcast
</span><span class="c1"></span>        <span class="n">Comp</span> <span class="n">comp</span> <span class="o">=</span> <span class="n">StaticFlight</span><span class="o">.</span><span class="na">comp</span><span class="o">();</span>
        <span class="n">StaticFlight</span><span class="o">.</span><span class="na">InnerDest</span> <span class="n">dest</span> <span class="o">=</span> <span class="n">StaticFlight</span><span class="o">.</span><span class="na">dest</span><span class="o">(</span><span class="s">&#34;GZ&#34;</span><span class="o">);</span>
      	<span class="c1">// ERROR! cannot access!
</span><span class="c1"></span>        <span class="c1">// StaticFlight.InnerComp.g();
</span><span class="c1"></span>      	<span class="c1">// 访问内部类静态域
</span><span class="c1"></span>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;StaticFlight.InnerDest.x = &#34;</span> <span class="o">+</span> <span class="n">StaticFlight</span><span class="o">.</span><span class="na">InnerDest</span><span class="o">.</span><span class="na">x</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">comp</span><span class="o">.</span><span class="na">showComp</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">dest</span><span class="o">.</span><span class="na">showDest</span><span class="o">());</span>
      	<span class="c1">// 访问内部类嵌套类静态方法
</span><span class="c1"></span>        <span class="n">StaticFlight</span><span class="o">.</span><span class="na">InnerDest</span><span class="o">.</span><span class="na">AnotherLevel</span><span class="o">.</span><span class="na">f</span><span class="o">();</span>
      	<span class="c1">// 获取内部类嵌套类实例并调用方法
</span><span class="c1"></span>        <span class="n">StaticFlight</span><span class="o">.</span><span class="na">InnerDest</span><span class="o">.</span><span class="na">AnotherLevel</span> <span class="n">l</span> <span class="o">=</span> <span class="n">dest</span><span class="o">.</span><span class="na">anotherLevel</span><span class="o">();</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;StaticFlight.InnerDest.AnotherLevel.p(): &#34;</span><span class="o">+</span> <span class="n">l</span><span class="o">.</span><span class="na">p</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">interface</span> <span class="nc">Dest</span> <span class="o">{</span>
    <span class="n">String</span> <span class="nf">showDest</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">interface</span> <span class="nc">Comp</span><span class="o">{</span>
    <span class="n">String</span> <span class="nf">showComp</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">StaticFlight</span><span class="o">{</span>
		 <span class="kd">private</span> <span class="kt">int</span> <span class="n">constant</span> <span class="o">=</span> <span class="n">10</span><span class="o">;</span>
     <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">constant_b</span> <span class="o">=</span> <span class="n">10</span><span class="o">;</span>
  	 <span class="c1">// 私有静态内部类
</span><span class="c1"></span>     <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">InnerComp</span> <span class="kd">implements</span> <span class="n">Comp</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">comp</span> <span class="o">=</span> <span class="s">&#34;AIR CHINA&#34;</span><span class="o">;</span>
       	<span class="c1">// ERROR! cannot access non-static filed of outer class
</span><span class="c1"></span>        <span class="c1">// private int a = constant;
</span><span class="c1"></span>        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">showComp</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">comp</span><span class="o">;</span> <span class="o">}</span>
       	<span class="c1">// 有限作用域
</span><span class="c1"></span>        <span class="kd">static</span> <span class="kt">void</span> <span class="nf">g</span><span class="o">(){</span> <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;g()&#34;</span><span class="o">);</span> <span class="o">}</span>
    <span class="o">}</span>
		
  	<span class="c1">// 静态内部类
</span><span class="c1"></span>    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">InnerDest</span> <span class="kd">implements</span> <span class="n">Dest</span><span class="o">{</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">to</span><span class="o">;</span>
        <span class="kd">private</span> <span class="nf">InnerDest</span><span class="o">(</span><span class="n">String</span> <span class="n">to</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">to</span> <span class="o">=</span> <span class="n">to</span><span class="o">;</span> <span class="o">}</span>

        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">showDest</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">to</span><span class="o">;</span> <span class="o">}</span>
        <span class="c1">// 静态域，能够访问外围类静态域
</span><span class="c1"></span>        <span class="kd">static</span> <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span>  <span class="n">constant_b</span><span class="o">;</span>
      	<span class="c1">// 嵌套静态内部类 
</span><span class="c1"></span>        <span class="kd">static</span> <span class="kd">class</span> <span class="nc">AnotherLevel</span><span class="o">{</span>
          	<span class="c1">// 静态方法
</span><span class="c1"></span>            <span class="kd">static</span> <span class="kt">void</span> <span class="nf">f</span><span class="o">(){</span> 
              <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;StaticFlight.InnerDest.AnotherLevel.x = &#34;</span> <span class="o">+</span> <span class="n">y</span><span class="o">);</span> 
            <span class="o">}</span>
            <span class="kt">int</span> <span class="nf">p</span><span class="o">(){</span> <span class="k">return</span> <span class="o">++</span><span class="n">x</span><span class="o">;</span> <span class="o">}</span>
            <span class="kd">static</span> <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">constant_b</span><span class="o">;</span>
          	<span class="c1">// same as 
</span><span class="c1"></span>          	<span class="c1">// static int y = x
</span><span class="c1"></span>        <span class="o">}</span>

        <span class="n">AnotherLevel</span> <span class="nf">anotherLevel</span><span class="o">(){</span> <span class="k">return</span> <span class="k">new</span> <span class="n">AnotherLevel</span><span class="o">();</span> <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="n">InnerComp</span> <span class="nf">comp</span><span class="o">(){</span> <span class="k">return</span> <span class="k">new</span> <span class="n">InnerComp</span><span class="o">();</span> <span class="o">}</span>

    <span class="kd">static</span> <span class="n">InnerDest</span> <span class="nf">dest</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">){</span> <span class="k">return</span> <span class="k">new</span> <span class="n">InnerDest</span><span class="o">(</span><span class="n">s</span><span class="o">);</span> <span class="o">}</span>
<span class="o">}</span>
<span class="o">/*</span>
<span class="n">StaticFlight</span><span class="o">.</span><span class="na">InnerDest</span><span class="o">.</span><span class="na">x</span> <span class="o">=</span> <span class="n">10</span>
<span class="n">AIR</span> <span class="n">CHINA</span>
<span class="n">GZ</span>
<span class="n">StaticFlight</span><span class="o">.</span><span class="na">InnerDest</span><span class="o">.</span><span class="na">AnotherLevel</span><span class="o">.</span><span class="na">x</span> <span class="o">=</span> <span class="n">10</span>
<span class="n">StaticFlight</span><span class="o">.</span><span class="na">InnerDest</span><span class="o">.</span><span class="na">AnotherLevel</span><span class="o">.</span><span class="na">p</span><span class="o">():</span> <span class="n">11</span>
<span class="o">///:~</span></code></pre></td></tr></table>
</div>
</div>
<p>上面的实例展示了上述静态内部类的性质</p>

<p>外围类的<code>comp()</code>和<code>dest()</code>方法被声明为静态的（非必须），说明<strong>不需要外围类实例即可创建内部类实例</strong>，在<code>main</code>方法里也是这么做的，而这是普通内部类无法完成的，如果试图这样做，会得到错误消息</p>

<blockquote>
<p>​ <em>&lsquo;xx.xx.x.outerClass.this&rsquo; cannot be referenced from a static context</em></p>
</blockquote>

<p>外围类定义了非静态字段<code>constant</code>和静态字段<code>constan_b</code>，在静态内部类中无法访问<code>constant</code>，却可以访问<code>constant_b</code></p>

<p>静态内部类可以嵌套，嵌套的内部类可以访问嵌入其的所有外围类的</p>

<p>静态内部类除了<code>static</code>数据和域存在特殊性之外，其他的使用和普通内部类无异</p>

<h2 id="10-6-接口中的内部类">10.6 接口中的内部类</h2>

<p>接口中的任何类都是<code>public</code>和<code>static</code>的，因此将静态内部类置于接口中并不违反接口的规则</p>

<p>甚至可以使接口中的内部类实现自其外围接口，参考下例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">InnerclassInterface</span> <span class="o">{</span>

    <span class="kt">void</span> <span class="nf">m</span><span class="o">();</span>

    <span class="kd">class</span> <span class="nc">Test</span> <span class="kd">implements</span> <span class="n">InnerclassInterface</span><span class="o">{</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">m</span><span class="o">()</span> <span class="o">{</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;man!&#34;</span><span class="o">);}</span>
    <span class="o">}</span>
  	<span class="c1">// static method in interface
</span><span class="c1"></span>  	<span class="kd">static</span> <span class="n">Test</span> <span class="nf">test</span><span class="o">(){</span><span class="k">return</span> <span class="k">new</span> <span class="n">Test</span><span class="o">();}</span>

    <span class="kd">class</span> <span class="nc">Main</span><span class="o">{</span>
        <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">Test</span> <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">();</span>
            <span class="n">test</span><span class="o">.</span><span class="na">m</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="o">/*</span>
<span class="n">man</span><span class="o">!</span>
<span class="o">///:~</span></code></pre></td></tr></table>
</div>
</div>
    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">wangy325</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2020-05-28
        <a href="https://github.com/wangy325/my_blog/commit/da95f6e88fbd403ff990ab4e42facf895554385c" title="git all hugo site">(da95f6e)</a>
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>
<div class="post-reward">
  <input type="checkbox" name="reward" id="reward" hidden />
  <label class="reward-button" for="reward">赞赏支持</label>
  <div class="qr-code">
    
    <label class="qr-code-image" for="reward">
        <img class="image" src="/endlessriver/img/reward/wechat.png">
        <span>微信打赏</span>
      </label>
    
  </div>
</div><footer class="post-footer">
      <div class="post-tags">
          <a href="/endlessriver/tags/java%E5%9F%BA%E7%A1%80/">Java基础</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/endlessriver/post/tech/basic_java/list/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">List—Java集合框架系列之一</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/endlessriver/post/tech/basic_java/lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/">
            <span class="next-text nav-default">lambda表达式—Java基础系列之八</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        <div id="disqus_thread"></div>
    <script type="text/javascript">
    (function() {
      
      
      if (window.location.hostname === 'localhost') return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'endlessriver';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=u8za1dzCiImO_8rKldjU1g" class="iconfont icon-email" title="email"></a>
      <a href="https://github.com/wangy325" class="iconfont icon-github" title="github"></a>
  <a href="https://wangy325.github.io/endlessriver/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    
    
  </div>

  <span class="copyright-year">
    &copy; 
    2019 - 
    2020
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">wangy325</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.min.js" integrity="sha256-jwCP0NAdCBloaIWTWHmW4i3snUNMHUNO+jr9rYd2iOI=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.locales.min.js" integrity="sha256-ZwofwC1Lf/faQCzN7nZtfijVV6hSwxjQMwXL4gn9qU8=" crossorigin="anonymous"></script>
  <script><!-- NOTE: timeago.js uses the language code format like "zh_CN" (underscore and case sensitive) -->
    var languageCode = "zh-cn".replace(/-/g, '_').replace(/_(.*)/, function ($0, $1) {return $0.replace($1, $1.toUpperCase());});
    timeago().render(document.querySelectorAll('.timeago'), languageCode);
    timeago.cancel();  
  </script>
<script type="text/javascript" src="/endlessriver/dist/even.26188efa.min.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"  integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>








</body>
</html>
